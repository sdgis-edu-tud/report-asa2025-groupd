<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.28">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Frederick Auer">
<meta name="author" content="Lin Ruofan">
<meta name="author" content="Matthijs Jerez Nova">
<meta name="author" content="Ula Kunigelyte">
<meta name="author" content="Finn van Asch">

<title>Title of your report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="report_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting-b719d3d4935f2b08311a76135e2bf442.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Title of your report</h1>
<p class="subtitle lead">Project report of Group D</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Frederick Auer </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            MSc Geomatics
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Lin Ruofan </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            MSc Landscape Architecture
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Matthijs Jerez Nova </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            MSc Urbanism
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Ula Kunigelyte </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            MSc Urbanism
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Finn van Asch </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            MSc Urbanism
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Urban areas across Europe are increasingly challenged by the impacts of climate change, biodiversity loss, and the demand for sustainable development <span class="citation" data-cites="nijkamp2013new">(<a href="#ref-nijkamp2013new" role="doc-biblioref">Nijkamp &amp; Kourtit, 2013</a>)</span>. According to <span class="citation" data-cites="article">(<a href="#ref-article" role="doc-biblioref">Diaz et al., 2019</a>)</span>, in cities the impact of land use on fresh-water ecosystems is especially severe. As climate change is expected to increase the intensity and frequency of extreme weather events, solutions to combat these effects are urgently needed <span class="citation" data-cites="ourloglou2020assessing">(<a href="#ref-ourloglou2020assessing" role="doc-biblioref">Ourloglou et al., 2020</a>)</span>.</p>
<p>A good solution is through urban streams. Urban streams are expected to have an important role in the mitigation of climate change by buffering extreme temperatures and prevent floods. More importantly, finding nature-based solutions are key and can restore existing strained water systems <span class="citation" data-cites="ourloglou2020assessing">(<a href="#ref-ourloglou2020assessing" role="doc-biblioref">Ourloglou et al., 2020</a>)</span>. In this context, spatial analytics can play a crucial role in informing climate adaptation and urban planning strategies <span class="citation" data-cites="hurlimann2012role">(<a href="#ref-hurlimann2012role" role="doc-biblioref">Hurlimann &amp; March, 2012</a>)</span>. Through methods such as Spatial Multi-Criteria Decision Analysis (S-MCDA) and typology development, planners and designers can better understand urban systems, evaluate trade-offs, and propose the correct targeted interventions.</p>
<p>The ReBioClim project, a European initiativve funded by the Interreg Central Europe Program <span class="citation" data-cites="rebioclim2024">(<a href="#ref-rebioclim2024" role="doc-biblioref"><em>Restoring Urban Streams to Promote Biodiversity, Climate Adaptation and to Improve Quality of Life in Cities – EU-Project ReBioClim Launched</em>, 2024</a>)</span>, exemplifies this approach by focusing on revitalizing small urban streams. It additionally provides a framework where nature-based solutions can be identified to enhance biodiversity, mitigate climate change effects, and improve urban living conditions <span class="citation" data-cites="rebioclim_ioer2024">(<a href="#ref-rebioclim_ioer2024" role="doc-biblioref"><em>ReBioClim – Leibniz Institute of Ecological Urban and Regional Development</em>, 2024</a>)</span>.Running from Juse 2204 to January 2027, the project addresses the challenges of urban stream restroration in four Central European cities, including Jablonec nad Nisou.</p>
<p>In this report, inspired by the ReBioClim project, we focus on the urban streams of Jablonec nad Nisou. Over recent decades, the city has experienced overbuilding, channelization, and neglect of its urban streams, leading to ecological degradation and reduced quality of life. Our objective is to quantitatively assess the current state of these waterways and identify areas with the highest potential for improvement. Through these efforts, we aim to provide a better understanding of where and how to restore the waterways and create green-blue corridors that offer cooling effects, improve air quality, and provide recreational spaces for residents.</p>
<p>Our research centers on the Bílá Nisa stream, and will address the problems we have identified through the lens fo the three following themes: Biodiversity, Climate Adaptation, and Quality of Life. These themes, relevant to our location has led to our main research question:</p>
<blockquote class="blockquote">
<p><em>(Where should urban stream restoration be prioritized in Jablonec nad Nisou to maximize biodiversity, climate adaptation, and quality of life?)</em></p>
</blockquote>
<p>Our derived subquestions, respective to each theme are then the following:</p>
<blockquote class="blockquote">
<p><em>(Where can the ecological quality of the stream area be enhanced?)</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>(Which areas are the most in need for flood protection?Where can flood mitigation measures take place?)</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>(Where can improvements in quality of life balance stakeholder interests in areas around the stream?)</em></p>
</blockquote>
<p>//we will add how the report is structured here after.</p>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<p>A important foundation for applying spatial analytics in urban environments is in the careful definition of the area of interest (AOI) and the spatial units used for analysis. The decisions regarding spatial scale, unit configuration, and data resolution directly influences the insights that can be drawn from spatial data. <span class="citation" data-cites="dungan2002balanced">(<a href="#ref-dungan2002balanced" role="doc-biblioref">Dungan et al., 2002</a>)</span> The justification of our area of interest and chosen spatial unit is structured around principles derived from literature, geographical context and data availability. Furthermore, in order to apply a S-MCDA normalized values at a comparable scale are needed, further emphasizing the importance of defining an appropriate spatial unit.</p>
<p><strong>Definition of Spatial Units</strong></p>
<p>To conduct a meaningful spatial analysis, the study area must be divided into standardized spatial units. For example, urban heat island and green infrastructure studies have shown to use a regular grid of 50 x 50 meter cells as the base unit of analysis <span class="citation" data-cites="BARTESAGHIKOC2020103893">(<a href="#ref-BARTESAGHIKOC2020103893" role="doc-biblioref">Bartesaghi-Koc et al., 2020</a>)</span>. However, based on our context and discussed principles affecting the conducted analysis, a spatial unit at 100 x 100 meters was chosen. The unit is used for consistency in the assignment of spatial indicators and facilitates the aggregation and comparison of data across the urban stream landscape. The 100 x 100m spatial unit is specific to the scale Jablonec nad Nisou, the resolution of the data collected and relevant literature on stream assessments.</p>
<p><strong>Impact of Scale on Detectable Effects</strong></p>
<p>The spatial resolution of the data we collected significantly shapes the analytical results. Averaging the data collected within the chosen 100 x 100m cells allows for generalized insights, which we found best fitting. It may however still obscure localized effects such as even smaller micro climatic benefits of tree clusters or linear vegetation elements. We chose the trade off that best fits our and balances detail with analytical feasibility.</p>
<p><strong>Resolution and Data Acquisition Method</strong></p>
<p>The resolution of spatial analysis is directly tied to the data acquisition method <span class="citation" data-cites="BARTESAGHIKOC2020103893">(<a href="#ref-BARTESAGHIKOC2020103893" role="doc-biblioref">Bartesaghi-Koc et al., 2020</a>)</span>. While spaceborne remote sensing, used for the measurement of some of our indicators when data availability was lacking, is better suited for large-scale urban assessments and often lacks the spatial precision needed for detailed micro climatic or ecological studies. On the other hand biodiversity and quality of life data are generally acquired at larger scale and would require smaller spatial units. For example, the widely accepted walking range of 500 meters <span class="citation" data-cites="macioszek2022effect popp2004walking">(<a href="#ref-macioszek2022effect" role="doc-biblioref">Macioszek et al., 2022</a>; <a href="#ref-popp2004walking" role="doc-biblioref">Popp et al., 2004</a>)</span>, or biodiversity connectivity of around 100m stretches, identified by <span class="citation" data-cites="RANTA2021106980">(<a href="#ref-RANTA2021106980" role="doc-biblioref">Ranta et al., 2021</a>)</span>. Our method reflects this balance, using satellite data for broader patterns such as LST and impervious surfaces. We then supplement this with higher-resolution sources for space syntax calculations, biotope values and ecologically valuable habitats, to name a few.</p>
<p><strong>Scale-Specific Indicators for Stream Assessment</strong></p>
<p>Urban stream analysis requires scale-appropriate methodologies. Different ecosystem services or hydrological characteristics demand different spatial extents. <span class="citation" data-cites="RANTA2021106980">(<a href="#ref-RANTA2021106980" role="doc-biblioref">Ranta et al., 2021</a>)</span> uses the following scales to assess the respective indicators.</p>
<ul>
<li><p><strong>100 m stream stretches</strong> are appropriate for biological assessments.</p></li>
<li><p><strong>500 m buffers</strong> may suit hydromorphological evaluations</p></li>
<li><p><strong>Entire sub-catchments</strong> can inform broader planning or restoration strategies.</p></li>
</ul>
<p>Therefore, when deciding on our scale, we considered our indicators and attempted to closely match them to retain a good representation of the spatial dynamics of the stream functions we aimed to analyze.</p>
<section id="identified-required-collected-data-per-respective-theme" class="level3">
<h3 class="anchored" data-anchor-id="identified-required-collected-data-per-respective-theme">Identified required collected data per respective theme</h3>
</section>
<section id="climate-adaptation" class="level3">
<h3 class="anchored" data-anchor-id="climate-adaptation">Climate Adaptation</h3>
</section>
<section id="biodiversity" class="level3">
<h3 class="anchored" data-anchor-id="biodiversity">Biodiversity</h3>
<p>For air quality, relabeling the RGB values to legend.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Green Band Value</th>
<th>SO₂ Range (µg/m³)</th>
<th>Color</th>
<th>Class Label</th>
<th>Class Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>168</td>
<td>0.0 – 0.1</td>
<td>Dark Green</td>
<td>Very Good</td>
<td>0</td>
</tr>
<tr class="even">
<td>201</td>
<td>0.1 – 0.2</td>
<td>Light Green</td>
<td>Good</td>
<td>1</td>
</tr>
<tr class="odd">
<td>237</td>
<td>0.2 – 0.5</td>
<td>Yellow</td>
<td>Moderate</td>
<td>2</td>
</tr>
<tr class="even">
<td>204</td>
<td>0.5 – 1.0</td>
<td>Light Orange</td>
<td>Poor</td>
<td>3</td>
</tr>
<tr class="odd">
<td>102</td>
<td>1.0 – 2.0</td>
<td>Dark Orange</td>
<td>Very Poor</td>
<td>4</td>
</tr>
<tr class="even">
<td>0</td>
<td>2.0 – 5.0</td>
<td>Red</td>
<td>Hazardous</td>
<td>5</td>
</tr>
</tbody>
</table>
</section>
<section id="mcda" class="level3">
<h3 class="anchored" data-anchor-id="mcda">MCDA</h3>
</section>
<section id="typology-construction" class="level3">
<h3 class="anchored" data-anchor-id="typology-construction">Typology construction</h3>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>:::</p>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-BARTESAGHIKOC2020103893" class="csl-entry" role="listitem">
Bartesaghi-Koc, C., Osmond, P., &amp; Peters, A. (2020). Quantifying the seasonal cooling capacity of <span>“green infrastructure types”</span> (GITs): An approach to assess and mitigate surface urban heat island in sydney, australia. <em>Landscape and Urban Planning</em>, <em>203</em>, 103893. https://doi.org/<a href="https://doi.org/10.1016/j.landurbplan.2020.103893">https://doi.org/10.1016/j.landurbplan.2020.103893</a>
</div>
<div id="ref-article" class="csl-entry" role="listitem">
Diaz, S., Settele, J., Brondízio, E., Ngo, H. T., Agard, J., Arneth, A., Balvanera, P., Brauman, K., Butchart, S., Chan, K., Garibaldi, L., Ichii, K., Liu, J., Subramanian, S., Midgley, G., Miloslavich, P., Molnár, Z., Obura, D., Pfaff, A., &amp; Zayas, C. (2019). Pervasive human-driven decline of life on earth points to the need for transformative change. <em>Science (New York, N.Y.)</em>, <em>366</em>. <a href="https://doi.org/10.1126/science.aax3100">https://doi.org/10.1126/science.aax3100</a>
</div>
<div id="ref-dungan2002balanced" class="csl-entry" role="listitem">
Dungan, J. L., Perry, J., Dale, M., Legendre, P., Citron-Pousty, S., Fortin, M.-J., Jakomulska, A., Miriti, M., &amp; Rosenberg, M. (2002). A balanced view of scale in spatial statistical analysis. <em>Ecography</em>, <em>25</em>(5), 626–640.
</div>
<div id="ref-hurlimann2012role" class="csl-entry" role="listitem">
Hurlimann, A. C., &amp; March, A. P. (2012). The role of spatial planning in adapting to climate change. <em>Wiley Interdisciplinary Reviews: Climate Change</em>, <em>3</em>(5), 477–488.
</div>
<div id="ref-macioszek2022effect" class="csl-entry" role="listitem">
Macioszek, E., Karami, A., Farzin, I., Abbasi, M., Mamdoohi, A. R., &amp; Piccioni, C. (2022). The effect of distance intervals on walking likelihood in different trip purposes. <em>Sustainability</em>, <em>14</em>(6), 3406.
</div>
<div id="ref-nijkamp2013new" class="csl-entry" role="listitem">
Nijkamp, P., &amp; Kourtit, K. (2013). The <span>“new urban europe”</span>: Global challenges and local responses in the urban century. <em>European Planning Studies</em>, <em>21</em>(3), 291–315.
</div>
<div id="ref-ourloglou2020assessing" class="csl-entry" role="listitem">
Ourloglou, O., Stefanidis, K., &amp; Dimitriou, E. (2020). Assessing nature-based and classical engineering solutions for flood-risk reduction in urban streams. <em>Journal of Ecological Engineering</em>, <em>21</em>(2), 46–56.
</div>
<div id="ref-popp2004walking" class="csl-entry" role="listitem">
Popp, M. M., Platzer, E., Eichner, M., &amp; Schade, M. (2004). Walking with and without walking: Perception of distance in large-scale urban areas in reality and in virtual reality. <em>Presence: Teleoperators &amp; Virtual Environments</em>, <em>13</em>(1), 61–76.
</div>
<div id="ref-RANTA2021106980" class="csl-entry" role="listitem">
Ranta, E., Vidal-Abarca, M. R., Calapez, A. R., &amp; Feio, M. J. (2021). Urban stream assessment system (UsAs): An integrative tool to assess biodiversity, ecosystem functions and services. <em>Ecological Indicators</em>, <em>121</em>, 106980. https://doi.org/<a href="https://doi.org/10.1016/j.ecolind.2020.106980">https://doi.org/10.1016/j.ecolind.2020.106980</a>
</div>
<div id="ref-rebioclim_ioer2024" class="csl-entry" role="listitem">
<em>ReBioClim – leibniz institute of ecological urban and regional development</em>. (2024). <a href="https://www.ioer.de/en/projects/rebioclim?utm_source=chatgpt.com" class="uri">https://www.ioer.de/en/projects/rebioclim?utm_source=chatgpt.com</a>.
</div>
<div id="ref-rebioclim2024" class="csl-entry" role="listitem">
<em>Restoring urban streams to promote biodiversity, climate adaptation and to improve quality of life in cities – EU-project ReBioClim launched</em>. (2024). <a href="https://tu-dresden.de/bu/umwelt/hydro/hydrobiologie/das-institut/news/restoring-urban-streams-to-promote-biodiversity-climate-adaptation-and-to-improve-quality-of-life-in-cities-eu-project-rebioclim-lauched?set_language=en&amp;utm_source=chatgpt.com" class="uri">https://tu-dresden.de/bu/umwelt/hydro/hydrobiologie/das-institut/news/restoring-urban-streams-to-promote-biodiversity-climate-adaptation-and-to-improve-quality-of-life-in-cities-eu-project-rebioclim-lauched?set_language=en&amp;utm_source=chatgpt.com</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>